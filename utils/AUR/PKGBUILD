# Maintainer: Erik Zenker <erikzenker@hotmail.com>
pkgname=open_dropbox
pkgver=20121011
pkgrel=1
pkgdesc="OpenDropbox is an Dropbox clone with more controll over your data"
arch=('i686' 'x86_64')
url="https://github.com/ezenker/open_dropbox"
license=('GPLv3')
depends=('rsync' 'sshfs' 'gtkmm3' 'boost-libs')
makedepends=('git')
provides=('opendropbox')
_gitroot=https://github.com/ezenker/$pkgname
_gitname=$pkgname


build() {
    cd $srcdir
    msg "Getting sources..."
   

   if [ -d $srcdir/$_gitname ] ; then
      (cd $_gitname && git pull origin master)
      	msg "The local files are updated."
   else
	git clone --depth=1 $_gitroot
   fi
   

    msg "GIT checkout done or server timeout"
    msg "Starting build..."

    cd $srcdir/$_gitname

    make inotify || return 1
    sudo -K
    make || return 1


}

package() {
  cd "$srcdir/$_gitname"
  install -m755 -d $pkgdir/etc/odb
  install -Dm755 odb.conf $pkgdir/etc/odb/odb.conf
  install -Dm755 scripts/mount_client.sh $pkgdir/etc/odb/mount_client.sh
  install -Dm755 odb $pkgdir/usr/bin/odb
}